<% content_for :title, "Slip Gaji" %>

<div class="max-w-2xl mx-auto bg-white shadow-lg rounded-lg p-8 mt-10 border border-gray-200">
  <!-- Header -->
  <div class="flex justify-between items-center border-b pb-4 mb-6">
    <div>
      <h1 class="text-xl font-bold text-gray-800">Slip Gaji</h1>
      <p class="text-sm text-gray-600">Periode: <%= Date::MONTHNAMES[@salary.month] %> <%= @salary.year %></p>
    </div>
    <div class="text-right">
      <p class="text-sm text-gray-600">Tanggal Cetak</p>
      <p class="text-base font-semibold"><%= l(Time.current.to_date, format: :long) %></p>
    </div>
  </div>

  <!-- Informasi Pegawai -->
  <div class="mb-6">
    <h2 class="text-lg font-semibold text-gray-700 mb-2">Informasi Penerima</h2>
    <table class="w-full text-sm text-gray-700">
      <tr>
        <td class="py-1 font-medium w-1/3">Nama</td>
        <td>: <%= @salary.user.name.presence || @salary.user.email %></td>
      </tr>
      <tr>
        <td class="py-1 font-medium">Jabatan</td>
        <td>: <%= @salary.user.role.titleize %></td>
      </tr>
      <tr>
        <td class="py-1 font-medium">Email</td>
        <td>: <%= @salary.user.email %></td>
      </tr>
      <tr>
        <td class="py-1 font-medium">No Rekening</td>
        <td>: <%= @salary.user.bank_account.presence || "-" %></td>
      </tr>
    </table>
  </div>

  <!-- Rincian Gaji -->
  <div class="mb-6">
    <h2 class="text-lg font-semibold text-gray-700 mb-2">Rincian Gaji</h2>
    <table class="w-full text-sm text-gray-700">
      <tr class="border-b">
        <td class="py-2 font-medium w-1/2">Jenis Gaji</td>
        <td>: <%= @salary.salary_type.humanize %></td>
      </tr>
      <tr class="border-b">
        <td class="py-2 font-medium">Jumlah Dasar</td>
        <td>: <%= number_to_currency(@salary.amount, unit: "Rp. ", delimiter: ".", separator: ",") %></td>
      </tr>
      <% if @salary.per_attendance? %>
        <tr class="border-b">
          <td class="py-2 font-medium">Jumlah Pertemuan</td>
          <td>: <%= @salary.user.attendances.where("extract(month from meeting_date) = ? AND extract(year from meeting_date) = ?", @salary.month, @salary.year).count %> x pertemuan</td>
        </tr>
      <% end %>
      <tr>
        <td class="py-2 font-bold">Total Gaji</td>
        <td class="font-bold text-green-700 text-lg">
          <%= number_to_currency(@salary.total_amount, unit: "Rp. ", delimiter: ".", separator: ",") %>
        </td>
      </tr>
    </table>
  </div>

  <!-- Status -->
  <div class="mb-6">
    <p class="text-sm text-gray-600">Status Pembayaran:</p>
    <span class="inline-block mt-1 px-3 py-1 text-sm font-semibold rounded-full
      <%= @salary.paid? ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800' %>">
      <%= @salary.status.humanize %>
    </span>
  </div>

  <!-- Tanda Tangan -->
  <div class="flex justify-between items-end mt-10">
    <div>
      <p class="text-sm text-gray-600">Dibuat oleh:</p>
      <p class="font-semibold text-gray-800 mt-10 underline">Admin</p>
    </div>

    <div class="text-right">
      <p class="text-sm text-gray-600">Diterima oleh:</p>
      <p class="font-semibold text-gray-800 mt-10 underline"><%= @salary.user.name.presence || @salary.user.email %></p>
    </div>
  </div>
</div>
